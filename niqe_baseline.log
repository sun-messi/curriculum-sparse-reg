/home/sunj11/anaconda3/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: 'Could not load this library: /home/sunj11/anaconda3/lib/python3.10/site-packages/torchvision/image.so'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Found 5000 images in /home/sunj11/Documents/U-ViT/eval_samples/celeba64_uvit_small/20251226_025347/100000_ema
Using device: cpu
Computing NIQE:   0%|          | 0/5000 [00:00<?, ?it/s]Computing NIQE:   1%|▏         | 64/5000 [00:00<00:07, 635.31it/s]Computing NIQE:   3%|▎         | 147/5000 [00:00<00:06, 746.61it/s]Computing NIQE:   5%|▍         | 228/5000 [00:00<00:06, 773.07it/s]Computing NIQE:   6%|▌         | 310/5000 [00:00<00:05, 790.36it/s]Computing NIQE:   8%|▊         | 397/5000 [00:00<00:05, 815.78it/s]Computing NIQE:  10%|▉         | 482/5000 [00:00<00:05, 826.00it/s]Computing NIQE:  11%|█▏        | 573/5000 [00:00<00:05, 850.31it/s]Computing NIQE:  13%|█▎        | 663/5000 [00:00<00:05, 865.24it/s]Computing NIQE:  15%|█▌        | 750/5000 [00:00<00:04, 861.25it/s]Computing NIQE:  17%|█▋        | 840/5000 [00:01<00:04, 871.79it/s]Computing NIQE:  19%|█▊        | 928/5000 [00:01<00:04, 874.06it/s]Computing NIQE:  20%|██        | 1018/5000 [00:01<00:04, 879.05it/s]Computing NIQE:  22%|██▏       | 1106/5000 [00:01<00:04, 870.26it/s]Computing NIQE:  24%|██▍       | 1194/5000 [00:01<00:04, 866.16it/s]Computing NIQE:  26%|██▌       | 1281/5000 [00:01<00:04, 807.55it/s]Computing NIQE:  27%|██▋       | 1369/5000 [00:01<00:04, 827.01it/s]Computing NIQE:  29%|██▉       | 1458/5000 [00:01<00:04, 844.72it/s]Computing NIQE:  31%|███       | 1551/5000 [00:01<00:03, 868.93it/s]Computing NIQE:  33%|███▎      | 1642/5000 [00:01<00:03, 880.29it/s]Computing NIQE:  35%|███▍      | 1736/5000 [00:02<00:03, 896.23it/s]Computing NIQE:  37%|███▋      | 1826/5000 [00:02<00:03, 871.54it/s]Computing NIQE:  38%|███▊      | 1919/5000 [00:02<00:03, 886.45it/s]Computing NIQE:  40%|████      | 2012/5000 [00:02<00:03, 897.91it/s]Computing NIQE:  42%|████▏     | 2102/5000 [00:02<00:03, 888.70it/s]Computing NIQE:  44%|████▍     | 2192/5000 [00:02<00:03, 859.86it/s]Computing NIQE:  46%|████▌     | 2279/5000 [00:02<00:03, 830.55it/s]Computing NIQE:  47%|████▋     | 2372/5000 [00:02<00:03, 858.43it/s]Computing NIQE:  49%|████▉     | 2463/5000 [00:02<00:02, 871.83it/s]Computing NIQE:  51%|█████     | 2554/5000 [00:02<00:02, 881.72it/s]Computing NIQE:  53%|█████▎    | 2647/5000 [00:03<00:02, 894.93it/s]Computing NIQE:  55%|█████▍    | 2737/5000 [00:03<00:02, 879.80it/s]Computing NIQE:  57%|█████▋    | 2826/5000 [00:03<00:02, 867.12it/s]Computing NIQE:  58%|█████▊    | 2913/5000 [00:03<00:02, 854.52it/s]Computing NIQE:  60%|█████▉    | 2999/5000 [00:03<00:02, 845.88it/s]Computing NIQE:  62%|██████▏   | 3084/5000 [00:03<00:02, 844.15it/s]Computing NIQE:  63%|██████▎   | 3169/5000 [00:03<00:02, 827.13it/s]Computing NIQE:  65%|██████▌   | 3254/5000 [00:03<00:02, 830.42it/s]Computing NIQE:  67%|██████▋   | 3339/5000 [00:03<00:01, 834.45it/s]Computing NIQE:  68%|██████▊   | 3424/5000 [00:04<00:01, 836.46it/s]Computing NIQE:  70%|███████   | 3510/5000 [00:04<00:01, 840.73it/s]Computing NIQE:  72%|███████▏  | 3595/5000 [00:04<00:01, 842.30it/s]Computing NIQE:  74%|███████▎  | 3681/5000 [00:04<00:01, 844.68it/s]Computing NIQE:  75%|███████▌  | 3766/5000 [00:04<00:01, 845.53it/s]Computing NIQE:  77%|███████▋  | 3851/5000 [00:04<00:01, 844.87it/s]Computing NIQE:  79%|███████▊  | 3936/5000 [00:04<00:01, 842.29it/s]Computing NIQE:  80%|████████  | 4021/5000 [00:04<00:01, 806.59it/s]Computing NIQE:  82%|████████▏ | 4102/5000 [00:04<00:01, 793.03it/s]Computing NIQE:  84%|████████▎ | 4186/5000 [00:04<00:01, 805.07it/s]Computing NIQE:  86%|████████▌ | 4276/5000 [00:05<00:00, 830.96it/s]Computing NIQE:  87%|████████▋ | 4360/5000 [00:05<00:00, 797.45it/s]Computing NIQE:  89%|████████▉ | 4441/5000 [00:05<00:00, 774.52it/s]Computing NIQE:  91%|█████████ | 4526/5000 [00:05<00:00, 795.24it/s]Computing NIQE:  92%|█████████▏| 4618/5000 [00:05<00:00, 830.75it/s]Computing NIQE:  94%|█████████▍| 4702/5000 [00:05<00:00, 828.95it/s]Computing NIQE:  96%|█████████▌| 4798/5000 [00:05<00:00, 864.71it/s]Computing NIQE:  98%|█████████▊| 4889/5000 [00:05<00:00, 876.00it/s]Computing NIQE: 100%|█████████▉| 4978/5000 [00:05<00:00, 880.07it/s]Computing NIQE: 100%|██████████| 5000/5000 [00:05<00:00, 846.99it/s]

Warning: Failed to compute NIQE for /home/sunj11/Documents/U-ViT/eval_samples/celeba64_uvit_small/20251226_025347/100000_ema/0.png: Expected 3D or 4D (batch mode) tensor with possibly 0 batch size and other non-zero dimensions for input, but got: [1, 1, 0, 0]

Warning: Failed to compute NIQE for /home/sunj11/Documents/U-ViT/eval_samples/celeba64_uvit_small/20251226_025347/100000_ema/1.png: Expected 3D or 4D (batch mode) tensor with possibly 0 batch size and other non-zero dimensions for input, but got: [1, 1, 0, 0]

Warning: Failed to compute NIQE for /home/sunj11/Documents/U-ViT/eval_samples/celeba64_uvit_small/20251226_025347/100000_ema/10.png: Expected 3D or 4D (batch mode) tensor with possibly 0 batch size and other non-zero dimensions for input, but got: [1, 1, 0, 0]

Warning: Failed to compute NIQE for /home/sunj11/Documents/U-ViT/eval_samples/celeba64_uvit_small/20251226_025347/100000_ema/100.png: Expected 3D or 4D (batch mode) tensor with possibly 0 batch size and other non-zero dimensions for input, but got: [1, 1, 0, 0]

Warning: Failed to compute NIQE for /home/sunj11/Documents/U-ViT/eval_samples/celeba64_uvit_small/20251226_025347/100000_ema/1000.png: Expected 3D or 4D (batch mode) tensor with possibly 0 batch size and other non-zero dimensions for input, but got: [1, 1, 0, 0]
Traceback (most recent call last):
  File "/home/sunj11/Documents/ddpm-torch/compute_niqe.py", line 91, in <module>
    score = compute_niqe_folder(folder)
  File "/home/sunj11/Documents/ddpm-torch/compute_niqe.py", line 65, in compute_niqe_folder
    raise ValueError(f"Failed to compute NIQE for any images in {folder_path}")
ValueError: Failed to compute NIQE for any images in /home/sunj11/Documents/U-ViT/eval_samples/celeba64_uvit_small/20251226_025347/100000_ema
